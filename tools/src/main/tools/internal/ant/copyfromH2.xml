<project name="copyFromH2" default="default" basedir=".">

	<import file="${basedir}/dbbase.xml" />
	
	<path id="h2.path">
		<fileset dir="${installation.tools.h2copy.dir}" >
			<include name="**/*.h2.db"/>
		</fileset>
	</path>

	<target name="showhelp">
		<echo message="使用说明:" />
		<echo message="0.本工具将会拷贝H2数据库表和数据到系统数据库." />
		<echo message="1.请将要导入的数据文件放在tools\db\h2下面，文件必须为有效的H2数据文件." />
		<echo message="2.更多信息请参阅文档." />
	</target>
	
	<target name="maintarget">
		<River-Menu addproperty="exit" choices="退出, 继续" prompt="如果拷贝过程出错是否退出？" save="false" />
		<River-Menu addproperty="clear" choices="清除, 不清除" prompt="如果目标表中已经存在数据，是否先做清除？" save="false" />
		<River-IfElse>
			<If property="clear" operator="==" value="不清除">
				<River-Menu addproperty="replace" choices="替换, 不替换" prompt="如果遇到数据冲突，是否替换原有数据？" save="false" />
			</If>
		</River-IfElse>
		<River-IfElse>
			<If property="exit" operator="==" value="退出">
				<River-Property addproperty="exitIfError" value="true" />
			</If>
			<Else>
				<River-Property addproperty="exitIfError" value="false" />
			</Else>
		</River-IfElse>
		<River-IfElse>
			<If property="clear" operator="==" value="清除">
				<River-Property addproperty="clearBeforeCopy" value="true" />
			</If>
			<Else>
				<River-Property addproperty="clearBeforeCopy" value="false" />
			</Else>
		</River-IfElse>
		<River-IfElse>
			<If property="replace" operator="==" value="替换">
				<River-Property addproperty="replaceIfConflict" value="true" />
			</If>
			<Else>
				<River-Property addproperty="replaceIfConflict" value="false" />
			</Else>
		</River-IfElse>

		<pathconvert property="jdbcpath" refid="tools.jdbc.properties.path"/>
		<pathconvert property="h2Path" refid="h2.path"/>
		
		<River-DB-Copy jdbcConf="file:///${jdbcpath}" fromH2="true" h2Path="${h2Path}" exitIfError="${exitIfError}" clearBeforeCopy="${clearBeforeCopy}" replaceIfConflict="${replaceIfConflict}"/>
	</target>

</project>